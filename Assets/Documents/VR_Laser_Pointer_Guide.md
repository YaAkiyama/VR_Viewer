# VRレーザーポインター実装ガイド

このドキュメントでは、MetaQuest3のホーム画面のようなVRレーザーポインターの実装方法と設定手順を説明します。

## 1. レーザーポインターの設定手順

### 基本設定

1. **コントローラーにレーザーポインターを設定する**
   - シーン内の`[BuildingBlock] Camera Rig`を探し、その下の`LeftControllerAnchor`または`RightControllerAnchor`を見つけます
   - コントローラーアンカーに`LaserPointer.prefab`をドラッグ＆ドロップするか、既存のオブジェクトに`VRLaserPointer`コンポーネントを追加します

2. **レーザーポインターの位置調整**
   - レーザーポインターのTransformを調整して、コントローラーの先端に合わせます
   - rayOriginが設定されていることを確認します（デフォルトでは自身のTransformを使用）

3. **マテリアルと色の設定**
   - レーザーポインターのマテリアルが正しく設定されていることを確認します
   - 必要に応じて色を調整します（青または紫が推奨）

### エディタツールを使用した設定

Unity Editorでは、以下のツールを使用して設定を簡単に行えます：

1. **VRLaserPointerのインスペクターツール**
   - VRLaserPointerコンポーネントを選択すると、インスペクターに追加設定が表示されます
   - 「コントローラーオリジンを自動検出」ボタンをクリックして、自動設定を行います
   - 「MetaQuest3スタイル（青/紫）」プリセットを選択できます

2. **レーザーマテリアル修正ツール**
   - メニューの「Tools > VR > レーザーポインターマテリアル修正」を選択します
   - 色やサイズを調整し、「すべてのレーザーポインターに適用」または「選択したコントローラーのレーザーに適用」をクリックします

## 2. レーザーポインターの動作確認

1. **レーザーの表示確認**
   - レーザーはコントローラーから短い先細りの光線として表示されるべきです
   - 色は鮮やかな青または紫で、先端に向かって透明になるグラデーションがかかります

2. **ポインタードットの確認**
   - UI要素や物体と交差すると、交点にドット（小さな球体）が表示されます
   - トリガーを押すとドットの色が変わります（デフォルトでは白→赤）

3. **インタラクションの確認**
   - UIボタンなどにポインターを合わせると、ハイライト表示されます
   - トリガーを引くとクリックイベントが発生します
   - サムネイルリスト上では、ドラッグによるスクロールが可能です

## 3. トラブルシューティング

### レーザーが表示されない場合

1. **コンポーネントの確認**
   - VRLaserPointerコンポーネントが正しく設定されているか確認します
   - LineRendererコンポーネントが自動生成されているか確認します

2. **マテリアルの確認**
   - LineRendererのマテリアルが正しく設定されているか確認します
   - 「レーザーマテリアル修正ツール」を使用して再設定します

### レーザーの色が間違っている場合

1. **マテリアルの修正**
   - VRLaserPointerの`rayColor`と`rayEndColor`を確認・修正します
   - LineRendererの`startColor`と`endColor`を確認・修正します
   - マテリアルの`_BaseColor`と`_EmissionColor`を確認・修正します

2. **エディタツールの使用**
   - 「レーザーマテリアル修正ツール」を使用して色を一括修正します

### レーザーの位置がずれている場合

1. **rayOriginの確認**
   - VRLaserPointerの`rayOrigin`が正しく設定されているか確認します
   - エディタの「コントローラーオリジンを自動検出」ボタンを使用します

2. **手動設定**
   - 「左コントローラーに設定」または「右コントローラーに設定」ボタンを使用します
   - あるいは手動でTransformをドラッグ＆ドロップで設定します

## 4. 高度なカスタマイズ

### レーザーの外観カスタマイズ

- `rayStartWidth`と`rayEndWidth`: レーザーの太さを調整します
- `maxVisualDistance`: レーザーの長さを調整します
- `rayColor`と`rayEndColor`: レーザーの色と透明度を調整します

### ポインタードットのカスタマイズ

- `dotScale`: ドットのサイズを調整します
- `dotColor`と`dotPressedColor`: ドットの色を調整します
- `pointerDotPrefab`: カスタムドットプレハブを設定できます

### スクロール動作のカスタマイズ

- `invertScrollDirection`: スクロール方向を反転します
- `scrollSensitivity`: スクロール感度を調整します
- `joystickScrollSensitivity`: ジョイスティックスクロールの感度を調整します

## 5. 注意事項

- レーザーポインターはUIインタラクションに最適化されています
- UIレイキャストのために、CanvasにGraphicRaycasterが必要です
- 複数のレーザーポインターを使用する場合は、それぞれに適切な設定が必要です
- URPを使用している場合、シェーダーが正しく設定されていることを確認してください
